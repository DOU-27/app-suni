{% extends "base/base.html" %}

{% load staticfiles widget_tweaks %}

{% block page_title %}
    {% if form.instance.id %}
        <title>Entrada {{ form.instance.id }}</title>
    {% else %}
        <title>Entrada</title>
    {% endif %}
{% endblock page_title %}

{% block content %}
{%if form.instance.en_creacion%}
<section class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-4">
                <div class="box">
                    <div class="box-header">
                        {% if form.instance.id %}
                            <h3 class="box-title">
                                Infomación de la entrada
                            </h3>
                        {% else %}
                            <h3 class="box-title">
                                <b>
                                    Entradas Existentes
                                </b>
                            </h3>
                        {% endif %}
                    </div>
                    <div class="box-body">
                        <table class="table table-condensed">
                            <tr>
                                <th>
                                    Número de entrada:
                                </th>
                                <td>
                                    {{ form.instance.id }}
                                </td>
                            </tr>
                            <tr>
                                <th>
                                    Tipo :
                                </th>
                                <td>
                                    {{ form.instance.tipo }}
                                </td>
                            </tr>

                            <tr>
                                <th>
                                    Proveedor:
                                </th>
                                <td>
                                    <a href="{{ form.instance.proveedor.get_absolute_url }}">
                                        {{ form.instance.proveedor }}
                                    </a>
                                </td>
                            </tr>
                            <tr>
                              <th>
                                Recibido por:
                              </th>
                              <td>
                                {{form.instance.recibida_por.get_full_name}}
                              </td>
                            </tr>
                            <tr>
                              <th>
                                Observaciones:
                              </th>
                              <td>
                                {{form.instance.observaciones |default_if_none:"No Existe Observaciones"}}
                              </td>
                            </tr>
                        </table>
                    </div>
                </div>
                <!--Fin de la Informacion-->
                <div class="box">
                    <div class="box-header">
                        <div class="row">
                            <div class="col-md-9">
                                <h3 class="box-title">Editar información</h3>
                            </div>
                        </div>
                    </div>
                    <div class="box-body table-responsive">
                        <table class="table table-condensed">
                            <form id="entrada-detalle-form" action="{% url 'entrada_update' pk=form.instance.id %}" method="post" data-api="{% url 'inventario_api:api_detalles-cuadrar-salida'%}" data-key="{{form.instance.id}}">
                                {% csrf_token %}
                                <table class="table table-condensed">
                                    {{ form.as_table }}
                                    <tr>
                                        <td>
                                            <input type="submit" class="btn btn-success" value="Guardar"/>
                                        </td>
                                    </tr>
                                </table>
                            </form>
                        </table>
                    </div>
                </div>
                <!--Fin de Entrada-->
                <div class="box">
                    <div class="box-header">
                        <div class="box-title">
                            <h3 class="box-title">Agregar equipo</h3>
                        </div>
                    </div>
                    <div class="box-body">
                        {% include "inventario/entrada/entradadetalle_add.html" %}
                    </div>
                </div>
            </div>
            <div class="col-md-8">
                <div class="box">
                    <div class="box-header">
                        <div class="box-title">
                            <h3 class="box-title">Detalle del equipo</h3>
                        </div>
                    </div>
                    <div class="box-body table-responsive">
                        <table id="entrada-table" class="table table-condensed"
                               data-api="{% url 'inventario_api:api_detalles-list' %}"
                               data-pk="{{ form.instance.id }}">
                            <thead>
                            <tr>
                                <th>Tipo de dispositivo</th>
                                <th>Útil</th>
                                <th>Repuesto</th>
                                <th>Desecho</th>
                                <th>Cantidad total</th>
                                <th>Precio Unitario</th>
                                <th>Precio Subtotal</th>
                                <th>Precio Descontado</th>
                                <th>Precio Total</th>
                                <th>Descripcion</th>
                                <th>Creado Por</th>
                                <th></th>
                                <th></th>
                                <th></th>
                            </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{%else%}
{%endif%}
{% endblock content %}
{% block extra_js %}
<script src="{% static "js/extrajs/inventario.js" %}"></script>
<script>
    AlertaEnCreacion.init();
    let pagina = new EntradaUpdate();
</script>
{% endblock extra_js %}
